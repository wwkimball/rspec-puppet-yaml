<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: RSpec::Puppet::Yaml::DataHelpers
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "RSpec::Puppet::Yaml::DataHelpers";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span>
     &raquo; 
    <span class="title">DataHelpers</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: RSpec::Puppet::Yaml::DataHelpers
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rspec-puppet-yaml/data_helpers.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A collection of static methods that help coerce data into simpler (to
digest) forms. This is necessitated primarily because YAML files can be
written with either String or Symbol keys for the same value and because
Hashes can be explicitly or implicitly named.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_array_of_named_hashes-class_method" title="get_array_of_named_hashes (class method)">.<strong>get_array_of_named_hashes</strong>(key, data = {})  &#x21d2; Array[Hash] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Condenses a collection of named Hashes into an Array-of-Hashes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_named_hash-class_method" title="get_named_hash (class method)">.<strong>get_named_hash</strong>(key, data = {}, default = {})  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets a named Hash child from a supplied Hash parent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_named_value-class_method" title="get_named_value (class method)">.<strong>get_named_value</strong>(key, data = {}, default = nil)  &#x21d2; Any </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets a named value from a Hash by its String and Symbol names.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make_hash_name_explicit-class_method" title="make_hash_name_explicit (class method)">.<strong>make_hash_name_explicit</strong>(transform_hash = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes a Hash, checks it for a name attribute, and ensures that name is a
string-named, &#39;name&#39;, attribute.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="get_array_of_named_hashes-class_method">
  
    .<strong>get_array_of_named_hashes</strong>(key, data = {})  &#x21d2; <tt>Array[Hash]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Condenses a collection of named Hashes into an Array-of-Hashes.</p>

<p>Accepts Hashes-of-Hashes – where each key is the entry&#39;s :name and –
Arrays-of-Hashes – where each Hash has a :name element – returning both
forms as an Array-of-Hashes with a guaranteed &#39;name&#39; element. Any
entry without a :name or &#39;name&#39; generates an exception.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>Enum[String,Symbol]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the collection to copy.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The Hash to copy <code>key</code> from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array[Hash]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array-of-Hashes, each with a &#39;name&#39; attribute.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>when an element has no name or is not a Hash.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec-puppet-yaml/data_helpers.rb', line 64</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_array_of_named_hashes'>get_array_of_named_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_hashes'>hashes</span>         <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RSpec::Puppet::Yaml::DataHelpers (module)">DataHelpers</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_named_value'><span class='object_link'><a href="#get_named_value-class_method" title="RSpec::Puppet::Yaml::DataHelpers.get_named_value (method)">get_named_value</a></span></span><span class='lparen'>(</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
    <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span>
    <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='kw'>if</span> <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='comment'># Supported Cases:
</span>  <span class='comment'># 1. [{&#39;this is a name&#39; =&gt; {:key =&gt; val}}, {&#39;this is also a name&#39; =&gt; {:key =&gt; val}}]
</span>  <span class='comment'># 2. {&#39;this is a name&#39; =&gt; {:key =&gt; value}, &#39;this is also a name&#39; =&gt; {:key =&gt; value}}
</span>  <span class='comment'># 3. [{:name =&gt; &#39;the name&#39;, :key =&gt; value}, {:name =&gt; &#39;another name&#39;, :key =&gt; value}]
</span>  <span class='comment'># 4. {:name =&gt; &#39;the name&#39;, :key =&gt; value}
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
      <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RSpec::Puppet::Yaml::DataHelpers (module)">DataHelpers</a></span></span>
        <span class='period'>.</span><span class='id identifier rubyid_make_hash_name_explicit'>make_hash_name_explicit</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='comment'># Supported Case 2 requires that each Hash attribute be a named Hash
</span>    <span class='comment'># when there is no explicit name attribute.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RSpec::Puppet::Yaml::DataHelpers (module)">DataHelpers</a></span></span>
        <span class='period'>.</span><span class='id identifier rubyid_make_hash_name_explicit'>make_hash_name_explicit</span><span class='lparen'>(</span><span class='id identifier rubyid_hashes'>hashes</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_hashes'>hashes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_k'>k</span> <span class='rbrace'>}</span>
        <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> indicates a Hash but at least one of its attributes is neither a Hash nor nil.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span>
            <span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>!=</span> <span class='symbol'>:name</span><span class='rbrace'>}</span>
            <span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_k'>k</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is for neither an Array nor a Hash value.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_coerced_hashes'>coerced_hashes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_named_hash-class_method">
  
    .<strong>get_named_hash</strong>(key, data = {}, default = {})  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets a named Hash child from a supplied Hash parent.</p>

<p>Attempts to get an immediate child Hash from a parent Hash that is named
according to a given key. The key may be supplied in either String or
Symbol form and both are searched for. When both forms exist in the parent
Hash, a shallow merge is attempted, favoring the String form.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>Enum[String,Symbol]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the child Hash.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The parent Hash.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>default</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The result when <code>key</code> not found.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The selected child Hash if it exists, else <code>default</code>.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>NameError when the value for <code>key</code> is not a Hash.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec-puppet-yaml/data_helpers.rb', line 122</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_named_hash'>get_named_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hash_value'>hash_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RSpec::Puppet::Yaml::DataHelpers (module)">DataHelpers</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_named_value'><span class='object_link'><a href="#get_named_value-class_method" title="RSpec::Puppet::Yaml::DataHelpers.get_named_value (method)">get_named_value</a></span></span><span class='lparen'>(</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span>
  <span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_hash_value'>hash_value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NameError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The value of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a Hash.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_hash_value'>hash_value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_named_value-class_method">
  
    .<strong>get_named_value</strong>(key, data = {}, default = nil)  &#x21d2; <tt>Any</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets a named value from a Hash by its String and Symbol names.</p>

<p>Searches a Hash for a key by both its String and Symbol names. When both
are found, they are merged as long as their values are both Hash (shallow)
or Array (unique). An exception is raised when the values are scalar or of
different data types.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>Enum[String,Symbol]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the child.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The parent Hash.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>default</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The result when <code>key</code> not found.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Any</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The selected value if it exists, else <code>default</code></p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>NameError when both String and Symbol forms <code>key</code> exist but one
cannot be merged into the other.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec-puppet-yaml/data_helpers.rb', line 145</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_named_value'>get_named_value</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_default'>default</span> <span class='kw'>unless</span> <span class='op'>!</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:has_key?</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_str_key'>str_key</span>     <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_sym_key'>sym_key</span>     <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
  <span class='id identifier rubyid_has_str_key'>has_str_key</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_str_key'>str_key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_has_sym_key'>has_sym_key</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_sym_key'>sym_key</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_has_str_key'>has_str_key</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_has_sym_key'>has_sym_key</span>
    <span class='id identifier rubyid_str_value'>str_value</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_str_key'>str_key</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_sym_value'>sym_value</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_sym_key'>sym_key</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_str_value'>str_value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sym_value'>sym_value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_sym_value'>sym_value</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_str_value'>str_value</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NameError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Both symbolic and string forms of &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str_key'>str_key</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; Hash declarations exist but one cannot be merged into the other.  Pick one form or the other or ensure both are Hashes that can be merged.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_str_value'>str_value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sym_value'>sym_value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_str_value'>str_value</span> <span class='op'>|</span> <span class='id identifier rubyid_sym_value'>sym_value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NameError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Both symbolic and string forms of &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str_key'>str_key</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; scalar declarations exist and they cannot be combined.  Pick one form or the other.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_has_str_key'>has_str_key</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_str_key'>str_key</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_has_sym_key'>has_sym_key</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_sym_key'>sym_key</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_default'>default</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_hash_name_explicit-class_method">
  
    .<strong>make_hash_name_explicit</strong>(transform_hash = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes a Hash, checks it for a name attribute, and ensures that name is a
string-named, &#39;name&#39;, attribute. If the Hash has no identifyable
name, an ArgumentError is raised.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>transform_hash</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A Hash that may already have an explicit name attribute in either string or
symbol form, or a Hash with an implicit name of form <code>{
&#39;implicit&#39; =&gt; { key... =&gt; val... } }</code>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Hash The <code>transform_hash</code> with an explicit, string key
&#39;name&#39; attribute.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>ArgumentError when <code>transform_hash</code> has neither an implicit nor
explicit name.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec-puppet-yaml/data_helpers.rb', line 19</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_make_hash_name_explicit'>make_hash_name_explicit</span><span class='lparen'>(</span><span class='id identifier rubyid_transform_hash'>transform_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot transform non-Hash data.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_transform_hash'>transform_hash</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_transformed_hash'>transformed_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_hash_name'>hash_name</span>        <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../RSpec.html" title="RSpec (module)">RSpec</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Puppet.html" title="RSpec::Puppet (module)">Puppet</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Yaml.html" title="RSpec::Puppet::Yaml (module)">Yaml</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="RSpec::Puppet::Yaml::DataHelpers (module)">DataHelpers</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_named_value'><span class='object_link'><a href="#get_named_value-class_method" title="RSpec::Puppet::Yaml::DataHelpers.get_named_value (method)">get_named_value</a></span></span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='id identifier rubyid_transform_hash'>transform_hash</span>
  <span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_hash_name'>hash_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_hash_name'>hash_name</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># Could be an implicit name when { &#39;implicit&#39; =&gt; { &#39;key&#39; =&gt; &#39;val&#39; } }
</span>    <span class='kw'>if</span> <span class='int'>1</span> <span class='op'>==</span> <span class='id identifier rubyid_transform_hash'>transform_hash</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
      <span class='id identifier rubyid_first_value'>first_value</span> <span class='op'>=</span> <span class='id identifier rubyid_transform_hash'>transform_hash</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_first_value'>first_value</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_first_value'>first_value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot transform implicitly named Hash when its value is neither nil nor a Hash.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_hash_name'>hash_name</span>        <span class='op'>=</span> <span class='id identifier rubyid_transform_hash'>transform_hash</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_hash_value'>hash_value</span>       <span class='op'>=</span> <span class='id identifier rubyid_first_value'>first_value</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
        <span class='id identifier rubyid_transformed_hash'>transformed_hash</span> <span class='op'>=</span> <span class='id identifier rubyid_hash_value'>hash_value</span>
          <span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:name</span><span class='rbrace'>}</span>
          <span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_hash_name'>hash_name</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='comment'># No explicit or implicit name
</span>      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hash has neither an explicit nor implicit name.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_transformed_hash'>transformed_hash</span> <span class='op'>=</span> <span class='id identifier rubyid_transform_hash'>transform_hash</span>
      <span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:name</span><span class='rbrace'>}</span>
      <span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_hash_name'>hash_name</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_transformed_hash'>transformed_hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Sep  6 04:17:57 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.4.1).
</div>

    </div>
  </body>
</html>